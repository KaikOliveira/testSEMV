{"code":"!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&n&&\"string\"!=typeof e)for(var i in e)t.d(r,i,function(t){return e[t]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\"a\",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=2)}([function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.Statement=void 0,t.Statement=class{constructor(e){this.stmt=e}getStatementInstance(){return this.stmt}bind(...e){return new Promise((t,n)=>{this.stmt.bind(...e,e=>e?n(e):void t())})}reset(){return new Promise(e=>{this.stmt.reset(()=>{e()})})}finalize(){return new Promise((e,t)=>{this.stmt.finalize(n=>n?t(n):void e())})}run(...e){return new Promise((t,n)=>{const r=this;this.stmt.run(...e,(function(e){return e?n(e):void t({stmt:r,lastID:this.lastID,changes:this.changes})}))})}get(...e){return new Promise((t,n)=>{this.stmt.get(...e,(e,r)=>e?n(e):void t(r))})}all(...e){return new Promise((t,n)=>{this.stmt.all(...e,(e,r)=>e?n(e):void t(r))})}each(...e){return new Promise((t,n)=>{const r=e.pop();if(!r||\"function\"!=typeof r)throw new Error(\"sqlite: Last param of Statement#each() must be a callback function\");if(0<e.length){const t=e.pop();if(\"function\"==typeof t)throw new Error(\"sqlite: Statement#each() should only have a single callback defined. See readme for usage.\");e.push(t)}this.stmt.each(...e,(e,t)=>e?r(e,null):void r(null,t),(e,r)=>e?n(e):void t(r))})}}},function(e){function t(){throw new Error(\"setTimeout has not been defined\")}function n(){throw new Error(\"clearTimeout has not been defined\")}function r(e){if(u===setTimeout)return setTimeout(e,0);if((u===t||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function i(){m&&f&&(m=!1,f.length?d=f.concat(d):h=-1,d.length&&o())}function o(){if(!m){var e=r(i);m=!0;for(var t=d.length;t;){for(f=d,d=[];++h<t;)f&&f[h].run();h=-1,t=d.length}f=null,m=!1,function(e){if(l===clearTimeout)return clearTimeout(e);if((l===n||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}(e)}}function a(e,t){this.fun=e,this.array=t}function s(){}var u,l,c=e.exports={};!function(){try{u=\"function\"==typeof setTimeout?setTimeout:t}catch(e){u=t}try{l=\"function\"==typeof clearTimeout?clearTimeout:n}catch(e){l=n}}();var f,d=[],m=!1,h=-1;c.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new a(e,t)),1!==d.length||m||r(o)},a.prototype.run=function(){this.fun.apply(null,this.array)},c.title=\"browser\",c.browser=!0,c.env={},c.argv=[],c.version=\"\",c.versions={},c.on=s,c.addListener=s,c.once=s,c.off=s,c.removeListener=s,c.removeAllListeners=s,c.emit=s,c.prependListener=s,c.prependOnceListener=s,c.listeners=function(){return[]},c.binding=function(){throw new Error(\"process.binding is not supported\")},c.cwd=function(){return\"/\"},c.chdir=function(){throw new Error(\"process.chdir is not supported\")},c.umask=function(){return 0}},function(e,t,n){n(3)},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.Database=t.Statement=t.open=void 0;const r=n(0);Object.defineProperty(t,\"Statement\",{enumerable:!0,get:function(){return r.Statement}});const i=n(4);Object.defineProperty(t,\"Database\",{enumerable:!0,get:function(){return i.Database}}),t.open=async function(e){const t=new i.Database(e);return await t.open(),t}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.Database=void 0;const r=n(0),i=n(5),o=n(8);t.Database=class{constructor(e){this.config=e,this.db=null}on(e,t){this.db.on(e,t)}getDatabaseInstance(){return this.db}open(){return new Promise((e,t)=>{let{filename:n,mode:r,driver:i}=this.config;if(null==n)throw new Error(\"sqlite: filename cannot be null / undefined\");if(!i)throw new Error(\"sqlite: driver is not defined\");this.db=r?new i(n,r,n=>n?t(n):void e()):new i(n,n=>n?t(n):void e())})}close(){return new Promise((e,t)=>{this.db.close(n=>n?t(n):void e())})}configure(e,t){this.db.configure(e,t)}run(e,...t){return new Promise((n,i)=>{const a=o.toSqlParams(e,t);this.db.run(a.sql,...a.params,(function(e){return e?i(e):void n({stmt:new r.Statement(this.stmt),lastID:this.lastID,changes:this.changes})}))})}get(e,...t){return new Promise((n,r)=>{const i=o.toSqlParams(e,t);this.db.get(i.sql,...i.params,(e,t)=>e?r(e):void n(t))})}each(e,...t){return new Promise((n,r)=>{const i=t.pop();if(!i||\"function\"!=typeof i)throw new Error(\"sqlite: Last param of Database#each() must be a callback function\");if(0<t.length){const e=t.pop();if(\"function\"==typeof e)throw new Error(\"sqlite: Database#each() should only have a single callback defined. See readme for usage.\");t.push(e)}const a=o.toSqlParams(e,t);this.db.each(a.sql,...a.params,(e,t)=>e?i(e,null):void i(null,t),(e,t)=>e?r(e):void n(t))})}all(e,...t){return new Promise((n,r)=>{const i=o.toSqlParams(e,t);this.db.all(i.sql,...i.params,(e,t)=>e?r(e):void n(t))})}exec(e){return new Promise((t,n)=>{const r=o.toSqlParams(e);this.db.exec(r.sql,e=>e?n(e):void t())})}prepare(e,...t){return new Promise((n,i)=>{const a=o.toSqlParams(e,t),s=this.db.prepare(a.sql,...a.params,e=>e?i(e):void n(new r.Statement(s)))})}loadExtension(e){return new Promise((t,n)=>{this.db.loadExtension(e,e=>e?n(e):void t())})}async migrate(e){await i.migrate(this,e)}serialize(){throw new Error(\"sqlite: Currently not implemented. Use getDatabaseInstance().serialize() instead.\")}parallelize(){throw new Error(\"sqlite: Currently not implemented. Use getDatabaseInstance().parallelize() instead.\")}}},function(e,t,n){\"use strict\";(function(e){async function r(t){const n=t||a.join(e.cwd(),\"migrations\"),r=a.resolve(n),s=await new Promise((e,t)=>{o.readdir(r,(n,r)=>n?t(n):void e(r.map(e=>e.match(/^(\\d+).(.*?)\\.sql$/)).filter(e=>null!==e).map(e=>({id:+e[1],name:e[2],filename:e[0]})).sort((e,t)=>i(e.id-t.id))))});if(!s.length)throw new Error(`No migration files found in '${r}'.`);return Promise.all(s.map(e=>new Promise((t,n)=>{const i=a.join(r,e.filename);o.readFile(i,\"utf-8\",(r,i)=>{if(r)return n(r);const[o,a]=i.split(/^--\\s+?down\\b/im),s=e;s.up=o.replace(/^-- .*?$/gm,\"\").trim(),s.down=a?a.trim():\"\",t(s)})})))}var i=Math.sign;Object.defineProperty(t,\"__esModule\",{value:!0}),t.migrate=t.readMigrations=void 0;const o=n(6),a=n(7);t.readMigrations=r,t.migrate=async function(e,t={}){t.force=t.force||!1,t.table=t.table||\"migrations\";const{force:n,table:o}=t,a=t.migrations?t.migrations:await r(t.migrationsPath);await e.run(`CREATE TABLE IF NOT EXISTS \"${o}\" (\\n  id   INTEGER PRIMARY KEY,\\n  name TEXT    NOT NULL,\\n  up   TEXT    NOT NULL,\\n  down TEXT    NOT NULL\\n)`);let s=await e.all(`SELECT id, name, up, down FROM \"${o}\" ORDER BY id ASC`);const u=a[a.length-1];for(const r of s.slice().sort((e,t)=>i(t.id-e.id))){if(a.some(e=>e.id===r.id)&&(!n||r.id!==u.id))break;await e.run(\"BEGIN\");try{await e.exec(r.down),await e.run(`DELETE FROM \"${o}\" WHERE id = ?`,r.id),await e.run(\"COMMIT\"),s=s.filter(e=>e.id!==r.id)}catch(t){throw await e.run(\"ROLLBACK\"),t}}const l=s.length?s[s.length-1].id:0;for(const n of a)if(n.id>l){await e.run(\"BEGIN\");try{await e.exec(n.up),await e.run(`INSERT INTO \"${o}\" (id, name, up, down) VALUES (?, ?, ?, ?)`,n.id,n.name,n.up,n.down),await e.run(\"COMMIT\")}catch(t){throw await e.run(\"ROLLBACK\"),t}}}}).call(this,n(1))},function(){},function(e,t,n){(function(e){function n(e,t){for(var n,r=0,i=e.length-1;0<=i;i--)\".\"===(n=e[i])?e.splice(i,1):\"..\"===n?(e.splice(i,1),r++):r&&(e.splice(i,1),r--);if(t)for(;r--;r)e.unshift(\"..\");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}t.resolve=function(){for(var t,i=\"\",o=!1,a=arguments.length-1;-1<=a&&!o;a--){if(\"string\"!=typeof(t=0<=a?arguments[a]:e.cwd()))throw new TypeError(\"Arguments to path.resolve must be strings\");t&&(i=t+\"/\"+i,o=\"/\"===t.charAt(0))}return(o?\"/\":\"\")+(i=n(r(i.split(\"/\"),(function(e){return!!e})),!o).join(\"/\"))||\".\"},t.normalize=function(e){var o=t.isAbsolute(e),a=\"/\"===i(e,-1);return(e=n(r(e.split(\"/\"),(function(e){return!!e})),!o).join(\"/\"))||o||(e=\".\"),e&&a&&(e+=\"/\"),(o?\"/\":\"\")+e},t.isAbsolute=function(e){return\"/\"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(r(e,(function(e){if(\"string\"!=typeof e)throw new TypeError(\"Arguments to path.join must be strings\");return e})).join(\"/\"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length&&\"\"===e[t];t++);for(var n=e.length-1;0<=n&&\"\"===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var i=r(e.split(\"/\")),o=r(n.split(\"/\")),a=Math.min(i.length,o.length),s=a,u=0;u<a;u++)if(i[u]!==o[u]){s=u;break}var l=[];for(u=s;u<i.length;u++)l.push(\"..\");return(l=l.concat(o.slice(s))).join(\"/\")},t.sep=\"/\",t.delimiter=\":\",t.dirname=function(e){if(\"string\"!=typeof e&&(e+=\"\"),0===e.length)return\".\";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,o=e.length-1;1<=o;--o)if(47!==(t=e.charCodeAt(o)))i=!1;else if(!i){r=o;break}return-1===r?n?\"/\":\".\":n&&1===r?\"/\":e.slice(0,r)},t.basename=function(e,t){var n=function(e){\"string\"!=typeof e&&(e+=\"\");var t,n=0,r=-1,i=!0;for(t=e.length-1;0<=t;--t)if(47!==e.charCodeAt(t))-1==r&&(i=!1,r=t+1);else if(!i){n=t+1;break}return-1===r?\"\":e.slice(n,r)}(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){\"string\"!=typeof e&&(e+=\"\");for(var t,n=-1,r=0,i=-1,o=!0,a=0,s=e.length-1;0<=s;--s)if(47!==(t=e.charCodeAt(s)))-1==i&&(o=!1,i=s+1),46===t?-1==n?n=s:1!=a&&(a=1):-1!==n&&(a=-1);else if(!o){r=s+1;break}return-1===n||-1===i||0==a||1==a&&n===i-1&&n===r+1?\"\":e.slice(n,i)};var i=function(e,t,n){return e.substr(t,n)}}).call(this,n(1))},function(e,t){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.toSqlParams=void 0,t.toSqlParams=function(e,t=[]){return\"string\"==typeof e?{sql:e,params:t}:{sql:e.sql,params:e.values}}}]);","extractedComments":[]}